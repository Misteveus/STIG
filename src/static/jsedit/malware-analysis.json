{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "malware-analysis",
    "description": "Malware Analysis captures the metadata and results of a particular analysis performed (static or dynamic) on the malware instance or family.",
    "type": "object",
    "$ref": "static/jsedit/core.json",
    "properties": {
        "id": {
            "title": "id",
            "pattern": "^malware-analysis--",
            "type": "string",
            "default": "malware-analysis--",
            "readonly": "true"
        },
        "type": {
            "type": "string",
            "description": "The type of this object, which MUST be the literal `malware-analysis`.",
            "default": "malware-analysis",
            "readonly": "true"
        },
        "product": {
            "type": "string",
            "description": "The name of the analysis engine or product that was used for this analysis."
        },
        "version": {
            "type": "string",
            "description": "The version of the analysis product that was used to perform this analysis."
        },
        "host_vm_ref": {
            "description": "A description of the virtual machine environment used to host the guest operating system (if applicable) that was used for the dynamic analysis of the malware instance or family.",
            "allOf": [
                {
                    "$ref": "static/jsedit/common/identifier.json"
                },
                {
                    "pattern": "^software--"
                }
            ]
        },
        "operating_system_ref": {
            "description": "The operating system that was used to perform the dynamic analysis.",
            "allOf": [
                {
                    "$ref": "static/jsedit/common/identifier.json"
                },
                {
                    "pattern": "^software--"
                }
            ]
        },
        "installed_software_refs": {
            "type": "array",
            "description": "Any non-standard software installed on the operating system used for the dynamic analysis of the malware instance or family.",
            "items": {
                "allOf": [
                    {
                        "$ref": "static/jsedit/common/identifier.json"
                    },
                    {
                        "pattern": "^software--"
                    }
                ]
            },
            "minItems": 1
        },
        "configuration_version": {
            "type": "string",
            "description": "The version of the analysis product configuration that was used to perform this analysis."
        },
        "modules": {
            "type" : "array",
            "items": {
                "type": "string"
            },
            "description": "The particular analysis product modules that were used to perform the analysis.",
            "minItems": 1
        },
        "analysis_engine_version": {
            "type": "string",
            "description": "The version of the analysis engine or product that was used to perform this analysis."
        },
        "analysis_definition_version": {
            "type": "string",
            "description": "The version of the analysis definitions used by the analysis tool."
        },
        "submitted": {
            "$ref": "static/jsedit/common/timestamp.json",
            "description": "The date and time that this malware was first submitted for scanning or analysis."
        },
        "analysis_started": {
            "$ref": "static/jsedit/common/timestamp.json",
            "description": "The date and time that the malware analysis was initiated."
        },
        "analysis_ended": {
            "$ref": "static/jsedit/common/timestamp.json",
            "description": "The date and time that the malware analysis ended."
        },
        "result_name": {
            "type": "string",
            "description": "The classification result or name assigned to the malware instance by the scanner tool."
        },
        "result": {
            "type": "string",
            "description": "The classification result as determined by the scanner or tool analysis process.",
            "$ref": "#/definitions/malware-result-ov"
        },
        "analysis_sco_refs": {
            "type": "array",
            "description": "The list of STIX objects that were captured during the analysis process.",
            "items": {
                "$ref": "static/jsedit/common/identifier.json"
            },
            "minItems": 1
        },
        "sample_ref": {
            "type": "string",
            "description": "This property contains the reference to the SCO file, network traffic or artifact object that this malware analysis was performed against.",
            "$ref": "static/jsedit/common/identifier.json"
        }
    },
    "required": [
        "product"
    ],
    "definitions": {
        "malware-result-ov": {
            "type": "string",
            "enum": [
                "malicious",
                "suspicious",
                "benign",
                "unknown"
            ]
        }
    }
}
